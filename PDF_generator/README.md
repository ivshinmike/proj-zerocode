### Генератор PDF чеков

**Назначение**: консольный Python-скрипт для генерации PDF‑чеков из CSV/JSON данных и HTML‑шаблонов с поддержкой кириллицы (через WeasyPrint).

### Структура проекта

- **main.py** – основной скрипт.
- **requirements.txt** – зависимости.
- **data** – сюда кладутся файлы данных (`*.csv`, `*.json`).
- **templates** – сюда кладутся HTML‑шаблоны (`*.html`, `*.htm`).
- **output** – сюда сохраняются сгенерированные PDF.
- **fonts** – шрифты для кириллицы (например, `DejaVuSans.ttf` или `Roboto-Regular.ttf`).

Каталоги `data`, `templates`, `output`, `fonts` создаются автоматически при первом запуске, если их нет.

### Зависимости и установка

Рекомендуется использовать виртуальное окружение:

```bash
python -m venv .venv
.venv\Scripts\activate       # Windows
source .venv/bin/activate    # macOS / Linux
pip install -r requirements.txt
```

На Windows и macOS WeasyPrint может требовать дополнительные системные библиотеки (см. документацию WeasyPrint).

### Настройка шрифта для кириллицы

- Скачайте шрифт **DejaVu Sans** или **Roboto** (обычный начертание, TTF).
- Поместите файл `DejaVuSans.ttf` или `Roboto-Regular.ttf` в папку `fonts` (рядом с `main.py`).
- Скрипт автоматически подключит найденный файл и применит его к `body` в PDF.

Если шрифт не найден, будет предупреждение, и WeasyPrint попытается использовать системные шрифты (кириллица может отображаться некорректно).

### Формат данных

- **CSV** – читается через `pandas.read_csv`. В таблице должна быть колонка с идентификатором чека (invoice id).
- **JSON**:
  - список объектов `[{...}, {...}]`, или
  - объект с ключом `"invoices"` (список), или
  - один объект `{...}`.

Скрипт попытается автоматически найти поле с invoice id среди:

`invoice_id`, `invoiceId`, `invoice`, `invoice_no`, `invoice_number`, `id`.

Если не найдёт – предложит выбрать поле вручную.

### HTML‑шаблоны

- Любые HTML‑файлы c кодировкой UTF‑8 в папке `templates`.
- Подстановка значений идёт через **Jinja2**, то есть в шаблоне можно использовать:

```html
{{ invoice_id }}
{{ customer_name }}
{{ total }}
```

и другие поля, соответствующие ключам в строке данных (записи).

### Использование

```bash
python main.py
```

Пошагово:

1. Скрипт показывает список файлов данных (`data`).
2. Скрипт показывает список HTML‑шаблонов (`templates`).
3. Вы выбираете один файл данных и один шаблон по номеру.
4. Скрипт читает данные и выводит список доступных invoice id.
5. Вы выбираете конкретный invoice id.
6. По выбранной записи генерируется HTML и создаётся PDF в папке `output`.
7. PDF автоматически открывается в системной программе (Windows – `os.startfile`, macOS – `open`, Linux – `xdg-open`, если есть).


